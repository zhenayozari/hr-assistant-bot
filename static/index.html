<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HR Assistant - –¢–µ—Å—Ç</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .status {
            display: inline-block;
            padding: 5px 15px;
            background: #10b981;
            color: white;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .card h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 20px;
        }
        
        .test-section {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .test-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        input, textarea {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 10px;
            transition: border 0.3s;
        }
        
        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .result {
            margin-top: 15px;
            padding: 15px;
            background: #f3f4f6;
            border-radius: 8px;
            font-family: monospace;
            font-size: 13px;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .success {
            background: #d1fae5;
            color: #065f46;
        }
        
        .error {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .label {
            display: block;
            margin-bottom: 5px;
            color: #6b7280;
            font-size: 13px;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ HR Assistant - –ü–∞–Ω–µ–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h1>
            <p style="color: #6b7280; margin-top: 10px;">Backend API: <span class="status" id="apiStatus">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span></p>
        </div>

        <!-- –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ API -->
        <div class="card">
            <h2>üîå –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API</h2>
            <div class="test-section">
                <button onclick="testConnection()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</button>
                <div id="connectionResult"></div>
            </div>
        </div>

        <!-- –¢–µ—Å—Ç 2: –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ—Ñ–∏–ª–µ–º -->
        <div class="card">
            <h2>üë§ –¢–µ—Å—Ç 2: –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ—Ñ–∏–ª–µ–º</h2>
            <div class="test-section">
                <label class="label">User ID:</label>
                <input type="text" id="userId" placeholder="test_user_123" value="test_user_123">
                <button onclick="getProfile()">–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
                <button onclick="updateProfile()" style="background: #10b981; margin-left: 10px;">–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
                <div id="profileResult"></div>
            </div>
        </div>

        <!-- –¢–µ—Å—Ç 3: HH.ru API Proxy -->
        <div class="card">
            <h2>üîó –¢–µ—Å—Ç 3: Proxy –¥–ª—è HH.ru API</h2>
            <div class="test-section">
                <label class="label">HH.ru Access Token (–µ—Å–ª–∏ –µ—Å—Ç—å):</label>
                <input type="text" id="hhToken" placeholder="–í—Å—Ç–∞–≤—å —Ç–æ–∫–µ–Ω –æ—Ç HH.ru">
                <button onclick="testHHProxy()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å /me endpoint</button>
                <div id="hhResult"></div>
            </div>
        </div>

        <!-- –¢–µ—Å—Ç 4: AI –ê–Ω–∞–ª–∏–∑ -->
        <div class="card">
            <h2>ü§ñ –¢–µ—Å—Ç 4: AI –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—é–º–µ</h2>
            <div class="test-section">
                <label class="label">–¢–µ—Å—Ç–æ–≤–æ–µ —Ä–µ–∑—é–º–µ:</label>
                <textarea id="resumeText" rows="4" placeholder="–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã: Senior Developer –≤ Google...">–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã:
- Senior Python Developer –≤ Google (2020-2023)
  –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ Python/FastAPI
- Middle Developer –≤ –Ø–Ω–¥–µ–∫—Å (2018-2020)

–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ:
- –ú–ì–£, —Ñ–∞–∫—É–ª—å—Ç–µ—Ç –í–ú–ö (2018)

–ù–∞–≤—ã–∫–∏: Python, FastAPI, Docker, PostgreSQL, React

–ñ–µ–ª–∞–µ–º–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞: 300000 RUB</textarea>
                
                <label class="label">–ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                <input type="text" id="criteria" placeholder="–ò—â–µ–º –æ–ø—ã—Ç–Ω–æ–≥–æ Python —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –∑–Ω–∞–Ω–∏–µ FastAPI –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ">
                
                <button onclick="analyzeResume()">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—é–º–µ</button>
                <div id="analyzeResult"></div>
            </div>
        </div>

    </div>

    <script>
        const API_BASE = 'https://zhenayozari-hr-assistant-bot-9ea4.twc1.net';

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = async () => {
            try {
                const res = await fetch(`${API_BASE}/`);
                const data = await res.json();
                document.getElementById('apiStatus').textContent = '‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç';
                document.getElementById('apiStatus').style.background = '#10b981';
            } catch (e) {
                document.getElementById('apiStatus').textContent = '‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç';
                document.getElementById('apiStatus').style.background = '#ef4444';
            }
        };

        // –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        async function testConnection() {
            const resultDiv = document.getElementById('connectionResult');
            resultDiv.innerHTML = '<div class="result">–ü—Ä–æ–≤–µ—Ä–∫–∞...</div>';
            
            try {
                const res = await fetch(`${API_BASE}/`);
                const data = await res.json();
                resultDiv.innerHTML = `<div class="result success">${JSON.stringify(data, null, 2)}</div>`;
            } catch (e) {
                resultDiv.innerHTML = `<div class="result error">–û—à–∏–±–∫–∞: ${e.message}</div>`;
            }
        }

        // –¢–µ—Å—Ç 2: –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
        async function getProfile() {
            const userId = document.getElementById('userId').value;
            const resultDiv = document.getElementById('profileResult');
            resultDiv.innerHTML = '<div class="result">–ó–∞–≥—Ä—É–∑–∫–∞...</div>';
            
            try {
                const res = await fetch(`${API_BASE}/api/profile/${userId}`);
                const data = await res.json();
                resultDiv.innerHTML = `<div class="result success">${JSON.stringify(data, null, 2)}</div>`;
            } catch (e) {
                resultDiv.innerHTML = `<div class="result error">–û—à–∏–±–∫–∞: ${e.message}</div>`;
            }
        }

        // –¢–µ—Å—Ç 2: –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
        async function updateProfile() {
            const userId = document.getElementById('userId').value;
            const resultDiv = document.getElementById('profileResult');
            resultDiv.innerHTML = '<div class="result">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...</div>';
            
            try {
                const res = await fetch(`${API_BASE}/api/profile/${userId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        hh_client_id: 'TEST_CLIENT_ID',
                        telegram_chat_ids: ['123456789']
                    })
                });
                const data = await res.json();
                resultDiv.innerHTML = `<div class="result success">–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª—ë–Ω:\n${JSON.stringify(data, null, 2)}</div>`;
            } catch (e) {
                resultDiv.innerHTML = `<div class="result error">–û—à–∏–±–∫–∞: ${e.message}</div>`;
            }
        }

        // –¢–µ—Å—Ç 3: HH.ru Proxy
        async function testHHProxy() {
            const token = document.getElementById('hhToken').value;
            const resultDiv = document.getElementById('hhResult');
            
            if (!token) {
                resultDiv.innerHTML = '<div class="result error">–í–≤–µ–¥–∏ —Ç–æ–∫–µ–Ω –æ—Ç HH.ru</div>';
                return;
            }
            
            resultDiv.innerHTML = '<div class="result">–ü—Ä–æ–≤–µ—Ä–∫–∞...</div>';
            
            try {
                const res = await fetch(`${API_BASE}/proxy/hh_api/me`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const data = await res.json();
                resultDiv.innerHTML = `<div class="result success">${JSON.stringify(data, null, 2)}</div>`;
            } catch (e) {
                resultDiv.innerHTML = `<div class="result error">–û—à–∏–±–∫–∞: ${e.message}</div>`;
            }
        }

        // –¢–µ—Å—Ç 4: AI –ê–Ω–∞–ª–∏–∑
        async function analyzeResume() {
            const resumeText = document.getElementById('resumeText').value;
            const criteria = document.getElementById('criteria').value;
            const resultDiv = document.getElementById('analyzeResult');
            
            resultDiv.innerHTML = '<div class="result">–ê–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ OpenAI...</div>';
            
            try {
                const res = await fetch(`${API_BASE}/api/analyze`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        full_resume: {
                            experience: [{ position: 'Developer', company: 'Test', description: resumeText }],
                            skill_set: ['Python', 'FastAPI']
                        },
                        criteria: criteria || '–û—Ü–µ–Ω–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞'
                    })
                });
                const data = await res.json();
                resultDiv.innerHTML = `<div class="result success">${JSON.stringify(data, null, 2)}</div>`;
            } catch (e) {
                resultDiv.innerHTML = `<div class="result error">–û—à–∏–±–∫–∞: ${e.message}</div>`;
            }
        }
    </script>
</body>
</html>
